<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Your Twitter Clone</title>
  <!-- Add your Firebase SDK scripts here -->
 
<script type="module">
  // Firebase configuration
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyB8_EeXv-jPv4Po0YpQOSIr46vTt9mQ7OI",
    authDomain: "healthy-firefly-401808.firebaseapp.com",
    projectId: "healthy-firefly-401808",
    storageBucket: "healthy-firefly-401808.appspot.com",
    messagingSenderId: "1018543693263",
    appId: "1:1018543693263:web:1087962325473897f846ba",
    measurementId: "G-FVSR9LKX88"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // Event listener for user registration form
  document.getElementById('registrationForm').addEventListener('submit', async function (e) {
    e.preventDefault();
    const username = document.getElementById('username').value;
    await createUserProfile(username);
  });

  // Event listener for posting a tweet
  document.getElementById('postForm').addEventListener('submit', async function (e) {
    e.preventDefault();
    const tweetText = document.getElementById('tweet').value;
    await postTweet(tweetText);
    displayTweets();
  });

  // Function to create a user profile
  async function createUserProfile(username) {
    try {
      const userRef = await addDoc(collection(db, 'users'), {
        username: username,
      });
      console.log('User profile created with ID: ', userRef.id);
    } catch (e) {
      console.error('Error creating user profile: ', e);
    }
  }

  // Function to post a tweet
  async function postTweet(tweetText) {
    try {
      await addDoc(collection(db, 'tweets'), {
        text: tweetText,
        timestamp: new Date(),
      });
      console.log('Tweet posted successfully!');
    } catch (e) {
      console.error('Error posting tweet: ', e);
    }
  }

  // Function to fetch and display tweets
  async function displayTweets() {
    const tweetsContainer = document.getElementById('tweets');
    tweetsContainer.innerHTML = ''; // Clear previous tweets

    try {
      const querySnapshot = await getDocs(collection(db, 'tweets'));
      querySnapshot.forEach((doc) => {
        const tweetData = doc.data();
        const tweetElement = document.createElement('div');
        tweetElement.innerHTML = `<p>${tweetData.text}</p>`;
        tweetsContainer.appendChild(tweetElement);
      });
    } catch (e) {
      console.error('Error fetching tweets: ', e);
    }
  }

  // Call the function to display tweets
  displayTweets();
</script>
</body>
</html>
